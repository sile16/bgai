{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 100,
      "title": "Training Overview",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 0, "y": 1 },
      "id": 1,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "bgai_model_version{worker_type=\"training\"}",
          "legendFormat": "Model Version",
          "refId": "A"
        }
      ],
      "title": "Model Version",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 4,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "red", "value": 2 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 3, "y": 1 },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
	      "targets": [
	        {
	          "expr": "max(bgai_training_loss{loss_type=\"total\"})",
	          "legendFormat": "Loss",
	          "refId": "A"
	        }
	      ],
      "title": "Training Loss",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 6, "y": 1 },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_training_steps_total)",
          "legendFormat": "Steps",
          "refId": "A"
        }
      ],
      "title": "Training Steps",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 5 }, { "color": "green", "value": 10 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 9, "y": 1 },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_training_steps_per_second)",
          "legendFormat": "Steps/s",
          "refId": "A"
        }
      ],
      "title": "Training Rate (steps/s)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 12, "y": 1 },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_training_batches_total)",
          "legendFormat": "Batches",
          "refId": "A"
        }
      ],
      "title": "Training Batches",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }, { "color": "green", "value": 5 }, { "color": "yellow", "value": 8 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 3, "x": 15, "y": 1 },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_games_since_last_train)",
	          "legendFormat": "Games (Episodes)",
          "refId": "A"
        }
      ],
      "title": "Games Since Train",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 2, "x": 18, "y": 1 },
      "id": 206,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_mcts_temperature)",
          "legendFormat": "Temperature",
          "refId": "A"
        }
      ],
      "title": "Epoch Temperature",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 2, "x": 20, "y": 1 },
      "id": 207,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_worker_num_simulations{worker_type=\"game\"})",
          "legendFormat": "Sims",
          "refId": "A"
        }
      ],
      "title": "MCTS Sims",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [
            {
              "options": {
                "0": { "text": "false" },
                "1": { "text": "true" }
              },
              "type": "value"
            }
          ],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "green", "value": 1 }] },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 2, "x": 22, "y": 1 },
      "id": 208,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_worker_short_game{worker_type=\"game\"})",
          "legendFormat": "short_game",
          "refId": "A"
        }
      ],
      "title": "Short Game",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "mappings": [
            { "options": { "0": { "color": "dark-gray", "index": 0, "text": "Idle" } }, "type": "value" },
            { "options": { "1": { "color": "green", "index": 1, "text": "Collecting" } }, "type": "value" },
            { "options": { "2": { "color": "blue", "index": 2, "text": "Training" } }, "type": "value" },
            { "options": { "3": { "color": "orange", "index": 3, "text": "Warm Tree" } }, "type": "value" },
            { "options": { "4": { "color": "purple", "index": 4, "text": "Checkpoint" } }, "type": "value" },
            { "options": { "5": { "color": "yellow", "index": 5, "text": "Sampling" } }, "type": "value" }
          ],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "dark-gray", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 8, "x": 0, "y": 5 },
      "id": 200,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "bgai_worker_phase{worker_type=\"training\"}",
          "legendFormat": "Training Worker",
          "refId": "A"
        }
      ],
      "title": "Training Worker Phase",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "mappings": [
            { "options": { "0": { "color": "dark-gray", "index": 0, "text": "Idle" } }, "type": "value" },
            { "options": { "1": { "color": "green", "index": 1, "text": "Collecting" } }, "type": "value" }
          ],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "dark-gray", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 8, "x": 8, "y": 5 },
      "id": 201,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "bgai_worker_phase{worker_type=\"game\"}",
          "legendFormat": "{{ worker_id }}",
          "refId": "A"
        }
      ],
      "title": "Game Workers Phase",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "stepAfter",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [
            { "options": { "0": { "index": 0, "text": "Idle" } }, "type": "value" },
            { "options": { "1": { "index": 1, "text": "Collecting" } }, "type": "value" },
            { "options": { "2": { "index": 2, "text": "Training" } }, "type": "value" },
            { "options": { "3": { "index": 3, "text": "Warm Tree" } }, "type": "value" },
            { "options": { "4": { "index": 4, "text": "Checkpoint" } }, "type": "value" },
            { "options": { "5": { "index": 5, "text": "Sampling" } }, "type": "value" }
          ],
          "max": 5,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 5 },
      "id": 202,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "single", "sort": "none" }
      },
      "targets": [
        {
          "expr": "bgai_worker_phase",
          "legendFormat": "{{ worker_id }}",
          "refId": "A"
        }
      ],
      "title": "Worker Phase Timeline",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 5 },
      "id": 7,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max(bgai_training_loss)",
          "legendFormat": "Training Loss",
          "refId": "A"
        }
      ],
      "title": "Training Loss Over Time",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 5 },
      "id": 8,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "sum(rate(bgai_training_steps_total[1m]))",
          "legendFormat": "Training Steps/s",
          "refId": "A"
        },
        {
          "expr": "sum(rate(bgai_collection_steps_total[1m]))",
          "legendFormat": "Collection Steps/s",
          "refId": "B"
        }
      ],
      "title": "Steps Rate Over Time",
      "type": "timeseries"
    },
	    {
	      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 13 },
	      "id": 108,
	      "title": "Value Head Metrics (4-way conditional)",
	      "type": "row"
	    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Loss",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 14 },
      "id": 70,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
	      "targets": [
	        {
	          "expr": "max(bgai_value_loss_per_output{output=\"win\"})",
	          "legendFormat": "Win",
	          "refId": "A"
	        },
	        {
	          "expr": "max(bgai_value_loss_per_output{output=\"gam_win_cond\"})",
	          "legendFormat": "Gammon Win | win",
	          "refId": "B"
	        },
	        {
	          "expr": "max(bgai_value_loss_per_output{output=\"gam_loss_cond\"})",
	          "legendFormat": "Gammon Loss | loss",
	          "refId": "C"
	        },
	        {
	          "expr": "max(bgai_value_loss_per_output{output=\"bg_rate\"})",
	          "legendFormat": "Backgammon rate",
	          "refId": "D"
	        }
	      ],
	      "title": "Per-Output Value Loss (4-way)",
	      "type": "timeseries"
	    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Probability",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 14 },
      "id": 71,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max(bgai_predicted_outcome_prob{outcome=\"win\"})",
          "legendFormat": "Pred Win",
          "refId": "A"
        },
        {
          "expr": "max(bgai_target_outcome_prob{outcome=\"win\"})",
          "legendFormat": "Target Win",
          "refId": "B"
        },
	        {
	          "expr": "1 - max(bgai_predicted_outcome_prob{outcome=\"win\"})",
	          "legendFormat": "Pred Loss",
	          "refId": "C"
	        },
	        {
	          "expr": "1 - max(bgai_target_outcome_prob{outcome=\"win\"})",
	          "legendFormat": "Target Loss",
	          "refId": "D"
	        }
	      ],
      "title": "Win/Loss Probability Calibration",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Probability",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 22 },
      "id": 72,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
	      "targets": [
	        {
	          "expr": "max(bgai_predicted_outcome_prob{outcome=\"gam_win_cond\"})",
	          "legendFormat": "Pred Gammon Win | win",
	          "refId": "A"
	        },
	        {
	          "expr": "max(bgai_target_outcome_prob{outcome=\"gam_win_cond\"})",
	          "legendFormat": "Target Gammon Win | win",
	          "refId": "B"
	        },
	        {
	          "expr": "max(bgai_predicted_outcome_prob{outcome=\"gam_loss_cond\"})",
	          "legendFormat": "Pred Gammon Loss | loss",
	          "refId": "C"
	        },
	        {
	          "expr": "max(bgai_target_outcome_prob{outcome=\"gam_loss_cond\"})",
	          "legendFormat": "Target Gammon Loss | loss",
	          "refId": "D"
	        },
	        {
	          "expr": "max(bgai_predicted_outcome_prob{outcome=\"bg_rate\"})",
	          "legendFormat": "Pred Backgammon rate",
	          "refId": "E"
	        },
	        {
	          "expr": "max(bgai_target_outcome_prob{outcome=\"bg_rate\"})",
	          "legendFormat": "Target Backgammon rate",
	          "refId": "F"
	        }
	      ],
      "title": "Gammon Probability Calibration",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Accuracy",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "green", "value": 0.8 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 22 },
      "id": 73,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max(bgai_value_accuracy)",
          "legendFormat": "Value Accuracy",
          "refId": "A"
        },
        {
          "expr": "max(bgai_policy_accuracy)",
          "legendFormat": "Policy Accuracy",
          "refId": "B"
        }
      ],
      "title": "Prediction Accuracy",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 2,
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "green", "value": 0.8 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 30 },
      "id": 74,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_value_accuracy)",
          "legendFormat": "Value Accuracy",
          "refId": "A"
        }
      ],
      "title": "Value Accuracy",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 2,
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "green", "value": 0.8 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 30 },
      "id": 75,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_policy_accuracy)",
          "legendFormat": "Policy Accuracy",
          "refId": "A"
        }
      ],
      "title": "Policy Accuracy",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 4,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 30 },
      "id": 76,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_training_loss{loss_type=\"value\"})",
          "legendFormat": "Value Loss",
          "refId": "A"
        }
      ],
      "title": "Value Loss",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 4,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 30 },
      "id": 77,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_training_loss{loss_type=\"policy\"})",
          "legendFormat": "Policy Loss",
          "refId": "A"
        }
      ],
      "title": "Policy Loss",
      "type": "stat"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 34 },
      "id": 101,
      "title": "Game Collection",
      "type": "row"
    },
	    {
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "fieldConfig": {
	        "defaults": {
	          "color": { "mode": "palette-classic" },
	          "mappings": [],
	          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
	          "unit": "short"
	        },
	        "overrides": []
	      },
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "fieldConfig": {
	        "defaults": {
	          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "green", "value": 1 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 14 },
      "id": 11,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "sum(bgai_games_per_minute)",
          "legendFormat": "Games/min",
          "refId": "A"
        }
      ],
      "title": "Games per Minute",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 14 },
      "id": 12,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "sum(bgai_collection_steps_per_second)",
          "legendFormat": "Steps/s",
          "refId": "A"
        }
      ],
      "title": "Collection Steps/s",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 14 },
      "id": 13,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "count(bgai_worker_status{worker_type=\"game\"} == 1)",
          "legendFormat": "Game Workers",
          "refId": "A"
        }
      ],
      "title": "Active Game Workers",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 14 },
      "id": 14,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "count(bgai_worker_status{worker_type=\"training\"} == 1)",
          "legendFormat": "Training Workers",
          "refId": "A"
        }
      ],
      "title": "Active Training Workers",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 14 },
      "id": 17,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "count(bgai_worker_status{worker_type=\"eval\"} == 1)",
          "legendFormat": "Eval Workers",
          "refId": "A"
        }
      ],
      "title": "Active Eval Workers",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 18 },
      "id": 15,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (worker_id) (bgai_games_per_minute)",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Games per Minute by Worker",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 18 },
      "id": 16,
      "options": {
        "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (worker_id) (bgai_collection_steps_per_second)",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Collection Steps/s by Worker",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 26 },
      "id": 102,
      "title": "Replay Buffer",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 27 },
      "id": 20,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_buffer_size)",
          "legendFormat": "Experiences",
          "refId": "A"
        }
      ],
      "title": "Buffer Size (Experiences)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 27 },
      "id": 21,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_buffer_games)",
	          "legendFormat": "Games (Episodes)",
          "refId": "A"
        }
      ],
	      "title": "Lifetime Games (Episodes)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 27 },
      "id": 22,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_buffer_episodes)",
	          "legendFormat": "Games (Episodes)",
          "refId": "A"
        }
      ],
	      "title": "Buffer Games (Episodes)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 27 },
      "id": 23,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_episodes_with_surprise)",
          "legendFormat": "Episodes",
          "refId": "A"
        }
      ],
      "title": "Episodes with Surprise",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 27 },
      "id": 204,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "sum(rate(bgai_games_truncated_total[1m])) * 60",
          "legendFormat": "Truncated/min",
          "refId": "A"
        }
      ],
      "title": "Truncated Games/min",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 27 },
      "id": 205,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "sum(rate(bgai_games_truncated_total[5m])) / clamp_min(sum(rate(bgai_games_truncated_total[5m])) + sum(rate(bgai_games_total[5m])), 1e-9)",
          "legendFormat": "Truncation rate",
          "refId": "A"
        }
      ],
      "title": "Truncation Rate",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 31 },
      "id": 24,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max(bgai_buffer_size)",
          "legendFormat": "Experiences",
          "refId": "A"
        },
        {
          "expr": "max(bgai_buffer_games)",
          "legendFormat": "Games",
          "refId": "B"
        }
      ],
      "title": "Buffer Size Over Time",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 31 },
      "id": 25,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max(bgai_surprise_score_max)",
          "legendFormat": "Max Surprise",
          "refId": "A"
        },
        {
          "expr": "max(bgai_surprise_score_mean)",
          "legendFormat": "Mean Surprise",
          "refId": "B"
        }
      ],
      "title": "Surprise Scores Over Time",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 39 },
      "id": 103,
      "title": "Surprise Score Distribution",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1.5 }, { "color": "red", "value": 2.5 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 40 },
      "id": 30,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_surprise_score_max)",
          "legendFormat": "Max",
          "refId": "A"
        }
      ],
      "title": "Max Surprise Score",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.75 }, { "color": "red", "value": 1.5 }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 40 },
      "id": 31,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "max(bgai_surprise_score_mean)",
          "legendFormat": "Mean",
          "refId": "A"
        }
      ],
      "title": "Mean Surprise Score",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Count",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 16, "x": 8, "y": 40 },
      "id": 32,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "increase(bgai_surprise_score_bucket[5m])",
          "legendFormat": "le={{le}}",
          "refId": "A"
        }
      ],
      "title": "Surprise Score Distribution (5m)",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 48 },
      "id": 104,
      "title": "System Resources",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "CPU %",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 49 },
      "id": 40,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host) (bgai_cpu_percent)",
          "legendFormat": "{{host}}",
          "refId": "A"
        }
      ],
      "title": "CPU Usage by Host",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "RAM %",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 49 },
      "id": 41,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host) (bgai_memory_percent)",
          "legendFormat": "{{host}}",
          "refId": "A"
        }
      ],
      "title": "System RAM Usage by Host",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "GPU %",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 57 },
      "id": 42,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host, gpu_index, gpu_name) (bgai_gpu_utilization_percent)",
          "legendFormat": "{{host}} ({{gpu_name}})",
          "refId": "A"
        }
      ],
      "title": "GPU Utilization by Host",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "GPU RAM %",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 57 },
      "id": 43,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host, gpu_index, gpu_name) (bgai_gpu_memory_percent)",
          "legendFormat": "{{host}} ({{gpu_name}})",
          "refId": "A"
        }
      ],
      "title": "GPU Memory Usage by Host",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Temperature C",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 85 }] },
          "unit": "celsius"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 65 },
      "id": 44,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host, gpu_index, gpu_name) (bgai_gpu_temperature_celsius)",
          "legendFormat": "{{host}} ({{gpu_name}})",
          "refId": "A"
        }
      ],
      "title": "GPU Temperature by Host",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Power (W)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 65 },
      "id": 45,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (host, gpu_index, gpu_name) (bgai_gpu_power_watts)",
          "legendFormat": "{{host}} ({{gpu_name}})",
          "refId": "A"
        }
      ],
      "title": "GPU Power Draw by Host",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 73 },
      "id": 109,
      "title": "JAX Memory (Actual vs Allocated)",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Memory",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 74 },
      "id": 110,
      "options": {
        "legend": { "calcs": ["lastNotNull", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "bgai_jax_memory_bytes_in_use",
          "legendFormat": "{{worker_id}} In Use",
          "refId": "A"
        },
        {
          "expr": "bgai_jax_memory_peak_bytes",
          "legendFormat": "{{worker_id}} Peak",
          "refId": "B"
        },
        {
          "expr": "bgai_jax_memory_bytes_limit",
          "legendFormat": "{{worker_id}} Limit",
          "refId": "C"
        }
      ],
      "title": "JAX Memory Usage Over Time",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 50 }, { "color": "red", "value": 80 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 74 },
      "id": 111,
      "options": {
        "displayMode": "lcd",
        "minVizHeight": 10,
        "minVizWidth": 0,
        "orientation": "horizontal",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "showUnfilled": true
      },
      "targets": [
        {
          "expr": "100 * bgai_jax_memory_peak_bytes / bgai_jax_memory_bytes_limit",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "JAX Peak Memory Usage % (Peak / Allocated)",
      "type": "bargauge"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "decgbytes"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 82 },
      "id": 112,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "bgai_jax_memory_peak_bytes / 1e9",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Peak Memory (GB)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "decgbytes"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 6, "x": 6, "y": 82 },
      "id": 113,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "bgai_jax_memory_bytes_limit / 1e9",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Allocated Memory (GB)",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 50 }, { "color": "red", "value": 80 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 6, "x": 12, "y": 82 },
      "id": 114,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "100 * bgai_jax_memory_peak_bytes / bgai_jax_memory_bytes_limit",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Peak Usage % of Allocated",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 2,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "decgbytes"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 82 },
      "id": 115,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "expr": "(bgai_jax_memory_bytes_limit - bgai_jax_memory_peak_bytes) / 1e9",
          "legendFormat": "{{worker_id}}",
          "refId": "A"
        }
      ],
      "title": "Wasted Memory (GB)",
      "type": "stat"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 86 },
      "id": 105,
      "title": "TPU Resources",
      "type": "row",
      "collapsed": true,
      "panels": [
        {
          "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "TPU %",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": true,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 74 },
          "id": 50,
          "options": {
            "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "expr": "bgai_tpu_duty_cycle_percent",
              "legendFormat": "{{host}} (TPU {{tpu_index}})",
              "refId": "A"
            }
          ],
          "title": "TPU Duty Cycle by Host",
          "type": "timeseries"
        },
        {
          "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "HBM %",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 20,
                "gradientMode": "none",
                "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": { "type": "linear" },
                "showPoints": "never",
                "spanNulls": true,
                "stacking": { "group": "A", "mode": "none" },
                "thresholdsStyle": { "mode": "off" }
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 70 }, { "color": "red", "value": 90 }] },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 74 },
          "id": 51,
          "options": {
            "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
            "tooltip": { "mode": "multi", "sort": "desc" }
          },
          "targets": [
            {
              "expr": "bgai_tpu_hbm_memory_percent",
              "legendFormat": "{{host}} (TPU {{tpu_index}})",
              "refId": "A"
            }
          ],
          "title": "TPU HBM Memory by Host",
          "type": "timeseries"
        }
      ]
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 82 },
      "id": 106,
      "title": "Worker Status",
      "type": "row"
    },
	    {
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "fieldConfig": {
	        "defaults": {
	          "mappings": [],
	          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
	          "unit": "short"
	        },
	        "overrides": [
	          {
	            "matcher": { "id": "byName", "options": "Status" },
	            "properties": [
	              { "id": "mappings", "value": [{ "options": { "0": { "color": "red", "index": 0, "text": "Stopped" }, "1": { "color": "green", "index": 1, "text": "Running" } }, "type": "value" }] },
	              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "green", "value": 1 }] } }
	            ]
	          },
	          {
	            "matcher": { "id": "byName", "options": "State" },
	            "properties": [
	              { "id": "mappings", "value": [{ "options": { "0": { "color": "dark-gray", "index": 0, "text": "Waiting" }, "1": { "color": "yellow", "index": 1, "text": "Compiling" }, "2": { "color": "green", "index": 2, "text": "Running" } }, "type": "value" }] }
	            ]
	          },
	          {
	            "matcher": { "id": "byName", "options": "Steps/s" },
	            "properties": [
	              { "id": "unit", "value": "ops" },
	              { "id": "decimals", "value": 2 }
	            ]
	          }
	        ]
	      },
	      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 83 },
	      "id": 60,
      "options": {
        "cellHeight": "sm",
        "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false },
        "showHeader": true,
        "sortBy": [{ "desc": false, "displayName": "worker_id" }]
      },
	      "pluginVersion": "11.3.0",
	      "targets": [
	        {
	          "expr": "bgai_worker_status * on(worker_id) group_left(device_type,device_kind) bgai_worker_info",
	          "format": "table",
	          "instant": true,
	          "legendFormat": "",
	          "refId": "A"
	        },
	        {
	          "expr": "bgai_worker_state * on(worker_id) group_left(device_type,device_kind) bgai_worker_info",
	          "format": "table",
	          "instant": true,
	          "legendFormat": "",
	          "refId": "B"
	        },
	        {
	          "expr": "bgai_worker_steps_per_second * on(worker_id) group_left(device_type,device_kind) bgai_worker_info",
	          "format": "table",
	          "instant": true,
	          "legendFormat": "",
	          "refId": "C"
	        },
	        {
	          "expr": "bgai_worker_batch_size * on(worker_id) group_left(device_type,device_kind) bgai_worker_info",
	          "format": "table",
	          "instant": true,
	          "legendFormat": "",
	          "refId": "D"
	        }
	      ],
	      "title": "Active Workers",
	      "transformations": [
	        { "id": "joinByField", "options": { "byField": "worker_id", "mode": "outer" } },
	        {
	          "id": "organize",
	          "options": {
	            "excludeByName": {
	              "Time": true,
	              "__name__": true,
	              "instance": true,
	              "job": true
	            },
	            "indexByName": {},
	            "renameByName": {
	              "Value": "Status",
	              "Value 1": "State",
	              "Value 2": "Steps/s",
	              "Value 3": "Batch Size",
	              "worker_id": "Worker ID",
	              "worker_type": "Type",
	              "device_type": "Device Type",
	              "device_kind": "Device Kind"
	            }
	          }
	        }
	      ],
	      "type": "table"
	    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "rate",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "ops"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 83 },
      "id": 203,
      "options": {
        "legend": { "calcs": [], "displayMode": "table", "placement": "right", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "none" }
      },
      "pluginVersion": "11.3.0",
      "targets": [
        {
          "expr": "max by (worker_id) (bgai_collection_steps_per_second)",
          "legendFormat": "collect {{worker_id}}",
          "refId": "A"
        },
        {
          "expr": "max by (worker_id) (bgai_training_steps_per_second)",
          "legendFormat": "train {{worker_id}}",
          "refId": "B"
        },
        {
          "expr": "sum by (worker_id) (rate(bgai_eval_games_total[5m]))",
          "legendFormat": "eval {{worker_id}}",
          "refId": "C"
        }
      ],
      "title": "Worker Throughput (collection/train/eval)",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 91 },
      "id": 107,
      "title": "Evaluation Metrics",
      "type": "row"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Win Rate",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.3 }, { "color": "green", "value": 0.5 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 92 },
      "id": 61,
      "options": {
        "legend": { "calcs": ["lastNotNull", "mean", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "max by (eval_type, model_version) (bgai_eval_win_rate{eval_type=\"random\"})",
          "legendFormat": "vs Random (v{{model_version}})",
          "refId": "A"
        },
        {
          "expr": "max by (eval_type, model_version) (bgai_eval_win_rate{eval_type=\"gnubg\"})",
          "legendFormat": "vs GNUBG (v{{model_version}})",
          "refId": "B"
        },
        {
          "expr": "max by (eval_type, model_version) (bgai_eval_win_rate{eval_type=\"self_play\"})",
          "legendFormat": "Self-Play (v{{model_version}})",
          "refId": "C"
        }
      ],
      "title": "Evaluation Win Rate Over Time",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Games",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 92 },
      "id": 62,
      "options": {
        "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "bottom", "showLegend": true },
        "tooltip": { "mode": "multi", "sort": "desc" }
      },
      "targets": [
        {
          "expr": "sum(bgai_eval_games_total) by (eval_type)",
          "legendFormat": "{{eval_type}}",
          "refId": "A"
        }
      ],
      "title": "Total Eval Games by Type",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.3 }, { "color": "green", "value": 0.5 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 100 },
      "id": 63,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "last_over_time(bgai_eval_win_rate{eval_type=\"random\"}[24h])",
          "legendFormat": "vs Random",
          "refId": "A"
        }
      ],
      "title": "Win Rate vs Random",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 0.2 }, { "color": "green", "value": 0.4 }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 100 },
      "id": 64,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "last_over_time(bgai_eval_win_rate{eval_type=\"gnubg\"}[24h])",
          "legendFormat": "vs GNUBG",
          "refId": "A"
        }
      ],
      "title": "Win Rate vs GNUBG",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] },
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 100 },
      "id": 65,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "last_over_time(bgai_eval_win_rate{eval_type=\"self_play\"}[24h])",
          "legendFormat": "Self-Play",
          "refId": "A"
        }
      ],
      "title": "Self-Play Win Rate",
      "type": "stat"
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "decimals": 1,
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 100 },
      "id": 66,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
        "textMode": "auto"
      },
      "targets": [
        {
          "expr": "last_over_time(bgai_eval_avg_game_length[24h])",
          "legendFormat": "Avg Length",
          "refId": "A"
        }
      ],
      "title": "Avg Game Length",
      "type": "stat"
    },
	    {
	      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 104 },
	      "id": 211,
	      "title": "MCTS",
	      "type": "row"
	    },
	    {
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "fieldConfig": {
	        "defaults": {
	          "color": { "mode": "palette-classic" },
	          "custom": {
	            "axisCenteredZero": false,
	            "axisColorMode": "text",
	            "axisLabel": "",
	            "axisPlacement": "auto",
	            "barAlignment": 0,
	            "drawStyle": "line",
	            "fillOpacity": 10,
	            "gradientMode": "none",
	            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
	            "lineInterpolation": "smooth",
	            "lineWidth": 2,
	            "pointSize": 5,
	            "scaleDistribution": { "type": "linear" },
	            "showPoints": "never",
	            "spanNulls": true,
	            "stacking": { "group": "A", "mode": "none" },
	            "thresholdsStyle": { "mode": "off" }
	          },
	          "mappings": [],
	          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
	          "unit": "none"
	        },
	        "overrides": []
	      },
	      "gridPos": { "h": 6, "w": 12, "x": 0, "y": 105 },
	      "id": 212,
	      "options": {
	        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
	        "tooltip": { "mode": "multi", "sort": "desc" }
	      },
	      "targets": [
	        {
	          "expr": "max by (worker_id) (bgai_mcts_temperature)",
	          "legendFormat": "{{worker_id}}",
	          "refId": "A"
	        }
	      ],
	      "title": "Temperature by Game Worker",
	      "type": "timeseries"
	    },
	    {
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "fieldConfig": {
	        "defaults": {
	          "color": { "mode": "palette-classic" },
	          "custom": {
	            "axisCenteredZero": false,
	            "axisColorMode": "text",
	            "axisLabel": "",
	            "axisPlacement": "auto",
	            "barAlignment": 0,
	            "drawStyle": "line",
	            "fillOpacity": 10,
	            "gradientMode": "none",
	            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
	            "lineInterpolation": "smooth",
	            "lineWidth": 2,
	            "pointSize": 5,
	            "scaleDistribution": { "type": "linear" },
	            "showPoints": "never",
	            "spanNulls": true,
	            "stacking": { "group": "A", "mode": "none" },
	            "thresholdsStyle": { "mode": "off" }
	          },
	          "mappings": [],
	          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
	          "unit": "short"
	        },
	        "overrides": []
	      },
	      "gridPos": { "h": 6, "w": 12, "x": 12, "y": 105 },
	      "id": 213,
	      "options": {
	        "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true },
	        "tooltip": { "mode": "multi", "sort": "desc" }
	      },
	      "targets": [
	        {
	          "expr": "max by (worker_id) (bgai_worker_num_simulations{worker_type=\"game\"})",
	          "legendFormat": "{{worker_id}}",
	          "refId": "A"
	        }
	      ],
	      "title": "MCTS Simulations by Game Worker",
	      "type": "timeseries"
	    },
	    {
	      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 111 },
	      "id": 209,
	      "title": "Glossary / Notes",
	      "type": "row"
	    },
	    {
	      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
	      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 112 },
	      "id": 210,
	      "options": {
	        "content": "### Losses\\n- **Training loss (total)** = `policy_loss + value_loss + l2_reg` (see `bgai_training_loss{loss_type=\\\"total\\\"}`).\\n- **Value loss** = BCE on the 4 value-head outputs; **Per-output value loss** is exported as `bgai_value_loss_per_output{output=...}`.\\n\\n### Terminology / Counters\\n- **Training step** = 1 optimizer update (1 batch); exported as `bgai_training_steps_total`. Each step consumes `train_batch_size` **experiences**.\\n- **Experience** = 1 position (state) + policy target + value target from self-play (roughly 1 ply of a game). `bgai_buffer_size` counts current experiences stored.\\n- **Game (Episode)** = 1 self-play trajectory stored as a unit in Redis (may be truncated at `max_episode_steps`).\\n  - **Buffer games (episodes)** = current games stored: `bgai_buffer_episodes` (bounded by `episode_capacity`).\\n  - **Lifetime games (episodes)** = total games ever added: `bgai_buffer_games` (monotonic; does not decrease when evicting).\\n- **Collection step** = 1 environment step (ply) across the self-play loop; each step includes running MCTS with `bgai_worker_num_simulations` rollouts per move.",
	        "mode": "markdown"
	      },
	      "title": "Glossary",
	      "type": "text"
	    }
	  ],
  "refresh": "10s",
  "schemaVersion": 38,
  "tags": ["bgai", "training", "alphazero"],
  "templating": {
    "list": [
      {
        "current": { "selected": false, "text": "Prometheus", "value": "prometheus" },
        "hide": 0,
        "includeAll": false,
        "label": "Prometheus",
        "multi": false,
        "name": "DS_PROMETHEUS",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {},
  "timezone": "",
  "title": "BGAI Training Dashboard",
  "uid": "bgai-training",
  "version": 1,
  "weekStart": ""
}
