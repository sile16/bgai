# BGAI Prometheus config with dynamic worker discovery
#
# Workers register their metrics endpoints in Redis.
# A background thread on the head node writes the discovery file.
# Prometheus auto-reloads targets every 15 seconds.

global:
  scrape_interval: 10s
  evaluation_interval: 10s

scrape_configs:
# Scrape BGAI workers (dynamically discovered via Redis)
- job_name: 'bgai_workers'
  file_sd_configs:
  - files:
    - 'bgai_prometheus_targets.json'
    refresh_interval: 15s

# Scrape Pushgateway (for workers that cannot be scraped, e.g. Colab)
- job_name: 'pushgateway'
  static_configs:
  - targets: ['127.0.0.1:9091']
